(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{402:function(s,t,a){"use strict";a.r(t);var n=a(13),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"高级特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#高级特性"}},[s._v("#")]),s._v(" 高级特性")]),s._v(" "),a("h2",{attrs:{id:"handlers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#handlers"}},[s._v("#")]),s._v(" Handlers")]),s._v(" "),a("p",[s._v("(TODO)")]),s._v(" "),a("p",[s._v("Such as: AfterArgParsed, AutomaticEnvHooks, ConfigLoadedListener, CustomShowBuildInfo, CustomShowVersions, ...")]),s._v(" "),a("h2",{attrs:{id:"智能建议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#智能建议"}},[s._v("#")]),s._v(" 智能建议")]),s._v(" "),a("p",[s._v("在用户输入了错误的命令（Command）、标志（Flag）时，cmdr 会停止进一步的解析，报错、并提出智能推断和建议。借助 subcommand 示例程序我们可以观察一下这个特性：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("❯ go run ./examples/subcommands/ --tree\nROOT\n  snd, soundex, sndx, sound - soundex "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n  pa, panic-test - "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" panic inside cmdr actions\n    dz, division-by-zero - \n    pa, panic - \n  d1, demo-1 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" check-in sub\n    d2, demo-2 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" check-in sub\n      d3, demo-3 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" check-in sub\n  sorted - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("grouped"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Tags operations\n    d1, demo-1 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" check-in sub\n    d2, demo-2 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" check-in sub\n    c1, cmd-1 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" check-in sub\n    c2, cmd-2 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" check-in sub\n    c3, cmd-3 - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" check-in sub\n  g, generate, gen - generators "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" this app.\n    s, shell, "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" - generate the bash/zsh auto-completion script or "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" it.\n    m, manual, "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("man")]),s._v(" - generate linux "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("man")]),s._v(" page.\n    d, doc, markdown, pdf, docx, tex - generate a markdown document, or: pdf/TeX/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n    \n❯ go run ./examples/subcommands/ pan\nsubcommands is an effective devops tool by hedzr - v1.0.0\n\nUsages:\n    subcommands "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Commands"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("tail args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Parent/Global Options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nDescription:\n    subcommands is an effective devops tool. It "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" an demo application "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("cmdr"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\nExamples:\n    \n    $ subcommands gen shell "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--bash"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--zsh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--auto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      generate bash/shell completion scripts\n    $ subcommands gen "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("man")]),s._v("\n      generate linux "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("man")]),s._v(" page "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    $ subcommands --help\n      show "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v(" screen.\n    \n\nCommands:\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Grouped"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  sorted                                     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("grouped"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Tags operations\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Nested"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  d1, demo-1                                 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sub"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" check-in sub\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  pa, panic-test                             "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" panic inside cmdr actions\n  snd, soundex, sndx, sound                  soundex "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Misc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  g, generate, gen                           generators "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" this app.\n\nOptions:\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Misc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      --config"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Locations of config files"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   load config files from where you specified "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Locations of config files"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  -q, --quiet                                No "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("screen")]),s._v(" output. "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("env: QUITE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  -v, --verbose                              Show this "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("screen")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("env: VERBOSE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nType "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-h'")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-?'")]),s._v(" or "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--help'")]),s._v(" to get "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v(" screen. \nMore: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-D'")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--debug'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--env'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--raw'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--more'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-V'")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--version'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-#'")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--build-info'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--no-color'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--strict-mode'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'--no-env-overrides'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\nUnknown command: pan\n  - "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" you mean: pa\n  - "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" you mean: panic-test\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br")])]),a("p",[s._v("可以见到，对于未知命令 “pan” 而言，cmdr 给出了两个意见，这或许能有助于用户解决自己的问题。")]),s._v(" "),a("p",[s._v("对于未知标志来说也是相似的。")]),s._v(" "),a("h3",{attrs:{id:"算法内幕"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#算法内幕"}},[s._v("#")]),s._v(" 算法内幕")]),s._v(" "),a("p",[s._v("cmdr 早期采用 soundex 算法进行相似度判定。")]),s._v(" "),a("p",[s._v("自从 cmdr v1.1.3 开始，我们使用更强大的 "),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Jaro%E2%80%93Winkler_distance",target:"_blank",rel:"noopener noreferrer"}},[s._v("Jaro-Winkler distance"),a("OutboundLink")],1),s._v(" 算法来提供更精准的建议。所以你会看到现在的建议值更符合期待。")]),s._v(" "),a("h3",{attrs:{id:"定制智能建议相似度"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定制智能建议相似度"}},[s._v("#")]),s._v(" 定制智能建议相似度")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://en.wikipedia.org/wiki/Jaro%E2%80%93Winkler_distance",target:"_blank",rel:"noopener noreferrer"}},[s._v("Jaro-Winkler distance"),a("OutboundLink")],1),s._v(" 算法对单词计算出一个浮点数来表示相似程度，这个值越接近 1.0 则表示相似度越高。cmdr 则使用一个阈值来决定两个单词是不是“相似的”。这个阈值默认为 0.6666666666666666。")]),s._v(" "),a("p",[s._v("可能从实际使用效果来看，这个阈值是相当合理的。但我们总是知道，这无法令所有人满意。所以你可以通过 "),a("code",[s._v("WithSimilarThreshold(similarThreshold)")]),s._v(" 来调整这个阈值。")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// WithSimilarThreshold defines a threshold for command/option similar detector.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Default threshold is 0.6666666666666666.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// See also JaroWinklerDistance")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("WithSimilarThreshold")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("similarThreshold "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("float64")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ExecOption "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("w "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("ExecWorker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("similarThreshold "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" similarThreshold\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("效果当然是见仁见智的。")]),s._v(" "),a("h3",{attrs:{id:"定制智能建议行为"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定制智能建议行为"}},[s._v("#")]),s._v(" 定制智能建议行为")]),s._v(" "),a("p",[s._v("通过 "),a("code",[s._v("WithUnknownOptionHandler")]),s._v(" 你可以指定一个错误选项捕获函数，然后自行决定应该如何向用户反馈该错误：")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// UnknownOptionHandler for WithSimilarThreshold/SetUnknownOptionHandler")]),s._v("\n\tUnknownOptionHandler "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("isFlag "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" title "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("Command"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fallbackToDefaultDetector "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("WithUnknownOptionHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("handler UnknownOptionHandler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ExecOption "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("w "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("ExecWorker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tunknownOptionHandler "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" handler\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("你可以编写一个 "),a("code",[s._v("UnknownOptionHandler")]),s._v(" 函数然后返回 false 来拒绝默认的智能建议内容，这样你的反馈就是唯一的给用户的信息。")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" myUnknownOptionHandler "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("isFlag "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" title "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("Command"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fallbackToDefaultDetector "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"halo terrible"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\nerr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cmdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Exec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("buildRootCmd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n                "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("WithUnknownOptionHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("myUnknownOptionHandler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n               "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h2",{attrs:{id:"panics"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#panics"}},[s._v("#")]),s._v(" Panics")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("See Also: "),a("a",{attrs:{href:"https://github.com/hedzr/cmdr-examples/blob/master/examples/panics",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/hedzr/cmdr-examples/blob/master/examples/panics"),a("OutboundLink")],1)])]),s._v(" "),a("p",[s._v("panic 的相关测试可以这样：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("go run ./examples/panics pa pa "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# panic test")]),s._v("\ngo run ./examples/panics pa pa --enable-ueh "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# panic test with UnhandledExceptionHandler")]),s._v("\ngo run ./examples/panics pa dz "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# divide by zero")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"onunhandlederrorhandler"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#onunhandlederrorhandler"}},[s._v("#")]),s._v(" onUnhandledErrorHandler")]),s._v(" "),a("p",[s._v("cmdr 内置了 recover 机制并将错误打包后返回到 Exec() 的调用者，但对于 onUnhandledError 可以单独处理：")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" main\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fmt"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/hedzr/cmdr"')]),s._v("\n\tcmdr_examples "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/hedzr/cmdr-examples"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/hedzr/cmdr/tool"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/hedzr/logex/logx/logrus"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gopkg.in/hedzr/errors.v2"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Entry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Entry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" cmdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Exec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("buildRootCmd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\tcmdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("WithLogx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logrus"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("New")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"debug"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\tcmdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("WithUnhandledErrorHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("onUnhandledErrorHandler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tcmdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Fatalf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"error: %+v"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("onUnhandledErrorHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" cmdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("GetBoolR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"enable-ueh"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dumpStacks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("panic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dumpStacks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tfmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"=== BEGIN goroutine stack dump ===\\n%s\\n=== END goroutine stack dump ===\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" errors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("DumpStacksAsString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br")])]),a("p",[s._v("这意味着当业务逻辑代码产生了异常时，你可以选择自己喜欢的提示方式。")]),s._v(" "),a("h2",{attrs:{id:"和-hedzr-log-的整合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#和-hedzr-log-的整合"}},[s._v("#")]),s._v(" 和 "),a("code",[s._v("hedzr/log")]),s._v(" 的整合")]),s._v(" "),a("h3",{attrs:{id:"最小的-logger-接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最小的-logger-接口"}},[s._v("#")]),s._v(" 最小的 Logger 接口")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://pkg.go.dev/github.com/hedzr/log?tab=doc",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("hedzr/log")]),a("OutboundLink")],1),s._v(" 是一个小型库，它提供了一个 logger 所必需的通用接口：")]),s._v(" "),a("h4",{attrs:{id:"logger"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#logger"}},[s._v("#")]),s._v(" Logger")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Logger is a minimal logger with no more dependencies")]),s._v("\n\tLogger "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Tracef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Debugf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Infof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Warnf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Errorf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Fatalf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("msg "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("interface")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("SetLevel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lvl Level"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("GetLevel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Level\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Setup will be invoked once an instance created")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// AsFieldLogger() FieldLogger")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("h4",{attrs:{id:"loggerconfig"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#loggerconfig"}},[s._v("#")]),s._v(" LoggerConfig")]),s._v(" "),a("p",[s._v("此外，一个专用的配置结构为：")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// LoggerConfig is used for creating a minimal logger with no more dependencies")]),s._v("\n\tLoggerConfig "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tEnabled   "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v("\n\t\tBackend   "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// zap, sugar, logrus")]),s._v("\n\t\tLevel     "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v("\n\t\tFormat    "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// text, json, ...")]),s._v("\n\t\tTarget    "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// console, file, console+file")]),s._v("\n\t\tDirectory "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("string")]),s._v("\n\t\tDebugMode "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('`json:"-" yaml:"-"`')]),s._v("\n\t\tTraceMode "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('`json:"-" yaml:"-"`')]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// MaxSize is the maximum size in megabytes of the log file before it gets")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// rotated. It defaults to 100 megabytes.")]),s._v("\n\t\tMaxSize "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('`json:"maxsize" yaml:"maxsize"`')]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// MaxAge is the maximum number of days to retain old log files based on the")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// timestamp encoded in their filename.  Note that a day is defined as 24")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// hours and may not exactly correspond to calendar days due to daylight")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// savings, leap seconds, etc. The default is not to remove old log files")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// based on age.")]),s._v("\n\t\tMaxAge "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('`json:"maxage" yaml:"maxage"`')]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// MaxBackups is the maximum number of old log files to retain.  The default")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// is to retain all old log files (though MaxAge may still cause them to get")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// deleted.)")]),s._v("\n\t\tMaxBackups "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('`json:"maxbackups" yaml:"maxbackups"`')]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// LocalTime determines if the time used for formatting the timestamps in")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// backup files is the computer's local time.  The default is to use UTC")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// time.")]),s._v("\n\t\tLocalTime "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('`json:"localtime" yaml:"localtime"`')]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Compress determines if the rotated log files should be compressed")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// using gzip. The default is not to perform compression.")]),s._v("\n\t\tCompress "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bool")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('`json:"compress" yaml:"compress"`')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br")])]),a("p",[a("a",{attrs:{href:"https://pkg.go.dev/github.com/hedzr/log?tab=doc",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("hedzr/log")]),a("OutboundLink")],1),s._v(" 所提供的 Logger 的最小化接口，有利于你采用自己喜欢的 Logger 后端。")]),s._v(" "),a("h4",{attrs:{id:"log-debugf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#log-debugf"}},[s._v("#")]),s._v(" log.Debugf, ...")]),s._v(" "),a("p",[s._v("在 "),a("a",{attrs:{href:"https://pkg.go.dev/github.com/hedzr/log?tab=doc",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("hedzr/log")]),a("OutboundLink")],1),s._v(" 中，提供了一组 package-level 的函数如 "),a("a",{attrs:{href:"https://github.com/hedzr/log/blob/v0.1.16/dummy.go#L124",target:"_blank",rel:"noopener noreferrer"}},[s._v("Debugf"),a("OutboundLink")],1),s._v("， "),a("a",{attrs:{href:"https://github.com/hedzr/log/blob/v0.1.16/dummy.go#L140",target:"_blank",rel:"noopener noreferrer"}},[s._v("Errorf"),a("OutboundLink")],1),s._v("，"),a("a",{attrs:{href:"https://github.com/hedzr/log/blob/v0.1.16/dummy.go#L144",target:"_blank",rel:"noopener noreferrer"}},[s._v("Fatalf"),a("OutboundLink")],1),s._v("，"),a("a",{attrs:{href:"https://github.com/hedzr/log/blob/v0.1.16/dummy.go#L130",target:"_blank",rel:"noopener noreferrer"}},[s._v("Infof"),a("OutboundLink")],1),s._v("， "),a("a",{attrs:{href:"https://github.com/hedzr/log/blob/v0.1.16/dummy.go#L136",target:"_blank",rel:"noopener noreferrer"}},[s._v("Warnf"),a("OutboundLink")],1),s._v(' 等等，它们是被固定封装到 go "log" 的函数。')]),s._v(" "),a("p",[s._v("这组函数允许你通过全局方式进行日志输出，如果你不介意后端总是 “log” 的话。")]),s._v(" "),a("h4",{attrs:{id:"cmdr-logger"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cmdr-logger"}},[s._v("#")]),s._v(" cmdr.Logger")]),s._v(" "),a("p",[s._v("cmdr 管理着一个全局变量")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" Logger log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Logger "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewDummyLogger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("通过 "),a("a",{attrs:{href:"https://github.com/hedzr/cmdr/blob/v1.7.9/logex.go#L23",target:"_blank",rel:"noopener noreferrer"}},[s._v("cmdr.WithLogx"),a("OutboundLink")],1),s._v("，你实际上指定了自己的 logger 并被保存到了这个全局变量中。")]),s._v(" "),a("p",[s._v("所以在全局，你可以借助它进行日志输出：")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("cmdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Fatalf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%v"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"内置-loggers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内置-loggers"}},[s._v("#")]),s._v(" 内置 Loggers")]),s._v(" "),a("p",[s._v("事实上，"),a("code",[s._v("hedzr/log")]),s._v(" 内置了两个基本的 Logger：")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("std "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewStdLogger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndummy "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewDummyLogger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("code",[s._v("std")]),s._v(" 是一个 go "),a("code",[s._v("log")]),s._v(" 的包装。")]),s._v(" "),a("p",[a("code",[s._v("dummy")]),s._v(" 是一个特殊的 logger，向它发出的日志全数都被抛弃。所以它被用于实现 "),a("code",[s._v("log.OffLevel")]),s._v(" 特性。")]),s._v(" "),a("h3",{attrs:{id:"和-hedzr-logex-相整合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#和-hedzr-logex-相整合"}},[s._v("#")]),s._v(" 和 "),a("code",[s._v("hedzr/logex")]),s._v(" 相整合")]),s._v(" "),a("p",[s._v("通过 "),a("code",[s._v("hedzr/logex")]),s._v(" 我们也提供了面向 logrus / zap 的 log.Logger 封装，你可以直接使用：")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/hedzr/cmdr"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/hedzr/log"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/hedzr/logex/build"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gopkg.in/hedzr/errors.v2"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Entry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tlogConfig "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewLoggerConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tlogConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Level "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"debug"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// off, fatal, error, warn, info, debug, trace")]),s._v("\n\tlogConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Backend "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"logrus"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// off, sugar, zap, logrus, std")]),s._v("\n  log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" build"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("New")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" cmdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Exec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("buildRootCmd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\tcmdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("WithLogx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tcmdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Fatalf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"error: %+v"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t\n\tcmdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Debugf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("借助于 "),a("code",[s._v("build.New(logConfig)")]),s._v("，你不必关心应该如何与某个 logger 后端完成整合，直接使用就好。")]),s._v(" "),a("h4",{attrs:{id:"直接建立-log-logger-实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#直接建立-log-logger-实例"}},[s._v("#")]),s._v(" 直接建立 log.Logger 实例")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("WithLogx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewDummyLogger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// import "github.com/hedzr/log"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("WithLogx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("NewStdLogger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// import "github.com/hedzr/log"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("WithLogx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logrus"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("New")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// import "github.com/hedzr/logex/logx/logrus"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("WithLogx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sugar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("New")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// import "github.com/hedzr/logex/logx/zap/sugar"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("WithLogx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("zap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("New")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// import "github.com/hedzr/logex/logx/zap"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"借助于配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#借助于配置文件"}},[s._v("#")]),s._v(" 借助于配置文件")]),s._v(" "),a("p",[s._v("LoggerConfig 在 cmdr 中可以通过配置文件映射的方式被构建：")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# autoconfig for logger/logging-system.")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cmdr will load this configuration and initialize the logging")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# system via build.New(loggerConfig).")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# see also:")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   cmdr.Logger,")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   log.LoggerConfig           (hedzr/log)")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   build.New(loggerConfig)    (hedzr/logex/build)")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("logger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The field 'level' will be reset to \"debug\" while the app")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# is started up within a debugger")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# available levels are:")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#   "disable"/"off", "panic", "fatal", "error", "warn",')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#   "info", "debug", "trace"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("level")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("  info\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("format")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" text                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# text, json, logfmt, ...")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("backend")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sugar                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# zap, sugar(sugared-zap) or logrus, std, off")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" console               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# console, file")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("directory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /var/log/$APPNAME\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("See Also: "),a("a",{attrs:{href:"https://github.com/hedzr/cmdr-examples/blob/master/examples/logging",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/hedzr/cmdr-examples/blob/master/examples/logging"),a("OutboundLink")],1)])]),s._v(" "),a("p",[s._v("运行该示例需要切换工作目录：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ./examples/logging\ngo run "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"扩展你自己的-logger"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#扩展你自己的-logger"}},[s._v("#")]),s._v(" 扩展你自己的 Logger")]),s._v(" "),a("p",[s._v("由于 "),a("code",[s._v("cmdr")]),s._v(" 最初的动因是源于微服务开发的实际需求，因此我们在 Logging 方面不太重视日志文件输出（但我们确实支持标准的 "),a("code",[s._v("/var/log/<appname>/<appname>.log")]),s._v("）、日志文件切割等场景，而是重视 stdout，stderr 输出能力。这里有两（、三）个理由：")]),s._v(" "),a("ol",[a("li",[s._v("在 K8s, Docker 场景中，日志应该被送至标准输出设备，基础设施负责对其重定向")]),s._v(" "),a("li",[s._v("在其他类似的场景中，同样是由基础设施来处理日志收集、集中问题，你没有理由自行开发日志旋转等等 "),a("code",[s._v("高级")]),s._v(" 特性")]),s._v(" "),a("li",[s._v("如果你真的需要例如 fluentd 的输出能力，好吧，借助 "),a("code",[s._v("log.Logger")]),s._v(" 实现一个外包装应该也很容易的。")])]),s._v(" "),a("h2",{attrs:{id:"debug-增强"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#debug-增强"}},[s._v("#")]),s._v(" Debug 增强")]),s._v(" "),a("h3",{attrs:{id:"tree"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tree"}},[s._v("#")]),s._v(" "),a("code",[s._v("~~tree")])]),s._v(" "),a("p",[a("code",[s._v("~~")]),s._v(" 会引入一个不包含 Options 前缀的内部命名空间。")]),s._v(" "),a("p",[a("code",[s._v("~~tree")]),s._v(" 是一个内置的特殊的命令行参数。它能够以层级缩进的方式打印出你的app的全部子命令列表：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://i.loli.net/2020/07/18/ZLJBzSlrKigvw5I.png",alt:"image-20200718084232522"}})]),s._v(" "),a("p",[s._v("这不仅有利于查找错误编码的关联关系，也有助于最终用户快速掌握 CLI 工具的全貌。")]),s._v(" "),a("h3",{attrs:{id:"debug"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#debug"}},[s._v("#")]),s._v(" "),a("code",[s._v("~~debug")])]),s._v(" "),a("p",[s._v("🔚")])])}),[],!1,null,null,null);t.default=e.exports}}]);